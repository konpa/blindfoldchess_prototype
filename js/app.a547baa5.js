(function(e){function t(t){for(var n,o,c=t[0],i=t[1],l=t[2],d=0,m=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&m.push(a[o][0]),a[o]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);u&&u(t);while(m.length)m.shift()();return s.push.apply(s,l||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,c=1;c<r.length;c++){var i=r[c];0!==a[i]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},a={app:0},s=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/blindfoldchess/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=i;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},5465:function(e,t,r){},"6b4a":function(e,t,r){"use strict";r("6f9c")},"6f9c":function(e,t,r){},a5d2:function(e,t,r){"use strict";r("5465")},cd49:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=r("2a13"),s=r.n(a),o=r("481d"),c={"t-button":{component:o["TButton"],props:{fixedClasses:"block px-4 py-2 transition duration-100 ease-in-out focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none focus:ring-opacity-50 disabled:opacity-50 disabled:cursor-not-allowed",classes:"text-white bg-blue-500 border border-transparent shadow-sm rounded hover:bg-blue-600",variants:{secondary:"text-gray-800 bg-white border border-gray-300 shadow-sm hover:text-gray-600",error:"text-white bg-red-500 border border-transparent rounded shadow-sm hover:bg-red-600",success:"text-white bg-green-500 border border-transparent rounded shadow-sm hover:bg-green-600",link:"text-blue-500 underline hover:text-blue-600"}}},"t-alert":{component:o["TAlert"],props:{fixedClasses:{wrapper:"relative flex items-center p-4 border-l-4  rounded shadow-sm",body:"flex-grow",close:"absolute relative flex items-center justify-center ml-4 flex-shrink-0 w-6 h-6 transition duration-100 ease-in-out rounded  focus:ring-2 focus:ring-blue-500 focus:outline-none focus:ring-opacity-50",closeIcon:"fill-current h-4 w-4"},classes:{wrapper:"bg-blue-50 border-blue-500",body:"text-blue-700",close:"text-blue-500 hover:bg-blue-200"},variants:{danger:{wrapper:"bg-red-50 border-red-500",body:"text-red-700",close:"text-red-500 hover:bg-red-200"},success:{wrapper:"bg-green-50 border-green-500",body:"text-green-700",close:"text-green-500 hover:bg-green-200"}}}}};n["default"].use(s.a,c);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"min-h-full flex items-center justify-center py-2 px-4 sm:px-6 lg:px-8",attrs:{id:"app"}},[r("div",{staticClass:"max-w-md w-full space-y-4"},[r("router-view")],1)])},l=[],u=(r("a5d2"),r("2877")),d={},m=Object(u["a"])(d,i,l,!1,null,null,null),h=m.exports,g=r("b85c"),f=(r("d3b7"),r("ddb0"),r("9483"));Object(f["a"])("".concat("/blindfoldchess/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh."),caches.keys().then((function(e){var t,r=Object(g["a"])(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;caches.delete(n)}}catch(a){r.e(a)}finally{r.f()}}))},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var p=r("8c4f"),v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"home"},[r("Login"),r("Games")],1)},b=[],w=r("bee2"),y=r("d4ec"),k=r("262e"),x=r("2caf"),_=r("9ab4"),A=r("1b40"),O=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mt-2 space-y-2"},[r("div",{staticClass:"flex justify-between items-center"},[r("h3",{staticClass:"text-lg leading-6 font-medium text-gray-900 uppercase"},[e._v(" Blindfold Lichess ")]),e.isLoggedIn?r("div",[r("a",{staticClass:"underline",attrs:{href:e.user.url,target:"_blank"}},[e._v(e._s(e.user.username))]),e._v(" / "),r("a",{staticClass:"underline",attrs:{href:"#"},on:{click:e.logout}},[e._v("logout")])]):r("div",[r("a",{staticClass:"underline",attrs:{href:"#"},on:{click:e.login}},[e._v("Login with lichess.org")])])]),e.error?r("t-alert",{attrs:{variant:"danger",show:""}},[e._v(" "+e._s(e.error)+" ")]):e._e()],1)},j=[],I=r("1da1"),G=r("5530"),L=(r("96cf"),r("3ca3"),r("2b3d"),r("9861"),r("ac1f"),r("841c"),r("2f62")),T=r("8c57"),C=n["default"].extend({data:function(){return{oauth:new T["OAuth2AuthCodePKCE"]({authorizationUrl:"https://lichess.org/oauth",tokenUrl:"https://lichess.org/api/token",clientId:"blindfoldchess.dev",scopes:["challenge:write","bot:play","board:play"],redirectUrl:function(){var e=new URL(window.location.href);return e.search="",e.href}(),onAccessTokenExpiry:function(e){return e()},onInvalidGrant:function(){}}),accessContext:{},user:{},error:""}},computed:Object(L["c"])(["lichessAccessToken","isLoggedIn"]),methods:Object(G["a"])(Object(G["a"])({},Object(L["b"])(["setLichessAccessToken","setIsLoggedIn"])),{},{login:function(){this.oauth.fetchAuthorizationCode()},getUsername:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://lichess.org/api/account",{method:"GET",headers:{Authorization:"Bearer ".concat(e.lichessAccessToken)}});case 2:return r=t.sent,t.next=5,r.json();case 5:e.user=t.sent;case 6:case"end":return t.stop()}}),t)})))()},logout:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.accessContext={},e.error="",e.user={},t.next=5,fetch("https://lichess.org/api/token",{method:"DELETE",headers:{Authorization:"Bearer ".concat(e.lichessAccessToken)}});case 5:e.$store.commit("setLichessAccessToken",""),e.$store.commit("setIsLoggedIn",!1),localStorage.removeItem("lichessAccessToken");case 8:case"end":return t.stop()}}),t)})))()}}),mounted:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!localStorage.lichessAccessToken){t.next=7;break}return e.$store.commit("setLichessAccessToken",localStorage.lichessAccessToken),e.$store.commit("setIsLoggedIn",!0),t.next=5,e.getUsername();case 5:t.next=23;break;case 7:return t.prev=7,t.next=10,e.oauth.isReturningFromAuthServer();case 10:if(r=t.sent,!r){t.next=18;break}return t.next=14,e.oauth.getAccessToken();case 14:return e.accessContext=t.sent,e.accessContext.token&&(e.$store.commit("setLichessAccessToken",e.accessContext.token.value),e.$store.commit("setIsLoggedIn",!0),localStorage.lichessAccessToken=e.accessContext.token.value),t.next=18,e.getUsername();case 18:t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](7),e.error=t.t0;case 23:case"end":return t.stop()}}),t,null,[[7,20]])})))()}}),S=C,M=Object(u["a"])(S,O,j,!1,null,null,null),R=M.exports,P=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.isLoggedIn?r("div",{staticClass:"mt-6"},[r("h2",{staticClass:"text-lg leading-6 font-medium text-gray-900"},[e._v(" Current game (Stockfish level "+e._s(e.AILevel)+") ")]),e.gameLink?r("div",{staticClass:"mt-2"},[e._v(" Analyze on Lichess: "),r("a",{staticClass:"underline",attrs:{href:e.gameLink,target:"_blank"}},[e._v(e._s(e.gameLink))]),r("br"),e._v(" Or copy/paste PGN: "),r("br"),r("div",{staticClass:"break-words bg-slate-300",domProps:{innerHTML:e._s(e.gamePGN)}})]):e._e(),e.playingGame?r("div",{staticClass:"mt-2"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.showBoardDiagram,expression:"showBoardDiagram"}],staticClass:"mr-2",attrs:{type:"checkbox",id:"showBoardDiagram",name:"showBoardDiagram"},domProps:{checked:Array.isArray(e.showBoardDiagram)?e._i(e.showBoardDiagram,null)>-1:e.showBoardDiagram},on:{change:function(t){var r=e.showBoardDiagram,n=t.target,a=!!n.checked;if(Array.isArray(r)){var s=null,o=e._i(r,s);n.checked?o<0&&(e.showBoardDiagram=r.concat([s])):o>-1&&(e.showBoardDiagram=r.slice(0,o).concat(r.slice(o+1)))}else e.showBoardDiagram=a}}}),r("label",{attrs:{for:"showBoardDiagram"}},[e._v("Show board diagram")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.showKeyboard,expression:"showKeyboard"}],staticClass:"ml-2 mr-2",attrs:{type:"checkbox",id:"showKeyboard",name:"showKeyboard"},domProps:{checked:Array.isArray(e.showKeyboard)?e._i(e.showKeyboard,null)>-1:e.showKeyboard},on:{change:function(t){var r=e.showKeyboard,n=t.target,a=!!n.checked;if(Array.isArray(r)){var s=null,o=e._i(r,s);n.checked?o<0&&(e.showKeyboard=r.concat([s])):o>-1&&(e.showKeyboard=r.slice(0,o).concat(r.slice(o+1)))}else e.showKeyboard=a}}}),r("label",{attrs:{for:"showKeyboard"}},[e._v("Show keyboard")])]):e._e(),e.playingGame&&e.showBoardDiagram?r("div",[r("img",{attrs:{src:e.boardImage}})]):e._e(),e.alertMessage?r("t-alert",{staticClass:"mt-2",attrs:{variant:e.alertVariant,show:""}},[e._v(" "+e._s(e.alertMessage)+" ")]):e._e(),e.playingGame?r("div",[r("div",{staticClass:"keyboard flex flex-wrap mt-2"},[e._l(e.keyboard,(function(t,n){return r("div",{key:n,class:["break"===t?"key-break":"key"],domProps:{innerHTML:e._s(t)},on:{click:function(r){return e.keyboardWrite(t)}}})})),r("div",{staticClass:"key key-erase",on:{click:function(t){return e.keyboardErase()}}},[e._v("⌫")]),r("div",{staticClass:"key key-enter",on:{click:e.sendMove}},[e._v("↵")])],2),e.isStreaming?r("span",[e._v(" Your move: "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.myNextMove,expression:"myNextMove"}],staticClass:"border-solid border-2 w-20 mt-2",attrs:{type:"text",autofocus:""},domProps:{value:e.myNextMove},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMove.apply(null,arguments)},input:function(t){t.target.composing||(e.myNextMove=t.target.value)}}}),e._v(" or "),r("a",{staticClass:"underline",attrs:{href:"#"},on:{click:e.resignGame}},[e._v("resign")])]):e._e(),r("ul",{staticClass:"mt-2"},e._l(e.gameLines,(function(t,n){return r("li",{key:n,domProps:{innerHTML:e._s(t)}})})),0)]):r("div",[e._v(" No current game -> "),r("a",{staticClass:"underline",attrs:{href:"#"},on:{click:e.challengeAI}},[e._v("Start a new game")]),r("span",[e._v(" (Stockfish level "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.AILevel,expression:"AILevel"}],attrs:{name:"AILevel",id:"AILevel-select"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.AILevel=t.target.multiple?r:r[0]}}},[r("option",{attrs:{value:"1"}},[e._v("1")]),r("option",{attrs:{value:"2"}},[e._v("2")]),r("option",{attrs:{value:"3"}},[e._v("3")]),r("option",{attrs:{value:"4"}},[e._v("4")]),r("option",{attrs:{value:"5"}},[e._v("5")]),r("option",{attrs:{value:"6"}},[e._v("6")]),r("option",{attrs:{value:"7"}},[e._v("7")]),r("option",{attrs:{value:"8"}},[e._v("8")])]),e._v(" ) ")])])],1):e._e()},B=[],N=r("53ca"),U=(r("1276"),r("4de4"),r("b64b"),r("a630"),r("99af"),r("fb6a"),r("c5ad")),$=r.n(U),D=function(e){return function(t){var r=t.body.getReader(),n=/\r?\n/,a=new TextDecoder,s="",o=function t(){return r.read().then((function(r){var o=r.done,c=r.value;if(!o){var i=a.decode(c,{stream:!0});s+=i;var l=s.split(n);s=l.pop();var u,d=Object(g["a"])(l.filter((function(e){return e})));try{for(d.s();!(u=d.n()).done;){var m=u.value;e(JSON.parse(m))}}catch(h){d.e(h)}finally{d.f()}return t()}return s.length>0&&e(JSON.parse(s)),!1}))};return o()}},E=n["default"].extend({data:function(){return{mostUrgentGame:{},chessGame:{},playingGame:!1,gameId:"",gameLines:[],gameWinner:"",gameLink:"",gamePGN:"",boardImage:"",AILevel:"1",numberOfMoves:0,myNextMove:"",alertMessage:"",alertVariant:"",showBoardDiagram:!1,isStreaming:!1,showKeyboard:!0,keyboard:["a","b","c","d","e","f","g","h","break","1","2","3","4","5","6","7","8","break","x","K","Q","R","B","N"]}},computed:Object(L["c"])(["lichessAccessToken","isLoggedIn"]),watch:{lichessAccessToken:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$store.state.isLoggedIn||!e.$store.state.lichessAccessToken){t.next=10;break}if(0!==Object.keys(e.mostUrgentGame).length){t.next=4;break}return t.next=4,e.getMostUrgentGame();case 4:if("string"!==typeof e.mostUrgentGame.gameId||!1!==e.isStreaming){t.next=10;break}return e.gameId=e.mostUrgentGame.gameId,e.chessGame=new $.a,e.playingGame=!0,t.next=10,e.streamGame(e.gameId);case 10:case"end":return t.stop()}}),t)})))()}},methods:{getMostUrgentGame:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://lichess.org/api/account/playing?nb=1",{method:"GET",headers:{Authorization:"Bearer ".concat(e.$store.state.lichessAccessToken)}});case 2:return r=t.sent,t.next=5,r.json();case 5:n=t.sent,n.nowPlaying&&n.nowPlaying[0]&&(e.mostUrgentGame=n.nowPlaying[0],e.AILevel=null===(a=e.mostUrgentGame)||void 0===a||null===(s=a.opponent)||void 0===s?void 0:s.ai);case 7:case"end":return t.stop()}}),t)})))()},streamGame:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function r(){var n,a,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=fetch("https://lichess.org/api/board/game/stream/".concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(t.$store.state.lichessAccessToken),Accept:"application/x-ndjson"}}),t.isStreaming=!0,a=function(e){if("gameState"===e.type&&e.winner&&"string"===typeof e.winner){t.gameWinner=e.winner;var r=t.chessGame.pgn();t.importGame(r),t.gamePGN=r}var n;if("gameState"===e.type)n=e.moves;else if("gameFull"===e.type){var a;if("object"===Object(N["a"])(e.state))n=null===(a=e.state)||void 0===a?void 0:a.moves}t.chessGame.load_pgn(n,{sloppy:!0});var s=t.chessGame.history(),o=1,c=Array.from(s,(function(e,t){if(t%2===0||0===t){var r='<span class="move-number">'.concat(o,".</span>");return r+='<span class="white-move">'.concat(s[t],"</span>"),void 0!==s[t+1]&&(r+='<span class="black-move">'.concat(s[t+1],"</span>")),o+=1,r}return null}));c=c.filter((function(e){return e})),t.gameLines=c.reverse(),t.boardImage="http://www.fen-to-image.com/image/26/double/coords/",t.boardImage+=t.chessGame.fen()},s=function(){t.alertMessage="The stream has completed.",t.alertVariant="",t.isStreaming=!1},n.then(D(a)).then(s);case 5:case"end":return r.stop()}}),r)})))()},challengeAI:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://lichess.org/api/challenge/ai",{method:"POST",headers:{Authorization:"Bearer ".concat(e.$store.state.lichessAccessToken)},body:new URLSearchParams({level:"1",color:"random",variant:"standard"})});case 2:return r=t.sent,t.next=5,r.json();case 5:if(e.gameId=t.sent.id,!e.gameId){t.next=11;break}return e.chessGame=new $.a,e.playingGame=!0,t.next=11,e.streamGame(e.gameId);case 11:case"end":return t.stop()}}),t)})))()},sendMove:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.chessGame.move(e.myNextMove);case 2:if(r=t.sent,null!==r){t.next=7;break}return e.alertMessage="This move is not legal!",e.alertVariant="danger",t.abrupt("return",!1);case 7:return t.next=9,fetch("https://lichess.org/api/board/game/".concat(e.gameId,"/move/").concat(r.from).concat(r.to),{method:"POST",headers:{Authorization:"Bearer ".concat(e.$store.state.lichessAccessToken)}});case 9:return n=t.sent,t.next=12,n.json();case 12:return a=t.sent,a.error?(e.alertMessage=a.error,e.alertVariant="danger"):(e.myNextMove="",e.alertMessage=""),t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t)})))()},importGame:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,fetch("https://lichess.org/api/import",{method:"POST",headers:{Authorization:"Bearer ".concat(t.$store.state.lichessAccessToken)},body:new URLSearchParams({pgn:e})});case 2:return n=r.sent,r.next=5,n.json();case 5:t.gameLink=r.sent.url;case 6:case"end":return r.stop()}}),r)})))()},resignGame:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://lichess.org/api/board/game/".concat(e.gameId,"/resign"),{method:"POST",headers:{Authorization:"Bearer ".concat(e.$store.state.lichessAccessToken)}});case 2:case"end":return t.stop()}}),t)})))()},keyboardWrite:function(e){this.myNextMove="".concat(this.myNextMove).concat(e)},keyboardErase:function(){this.myNextMove=this.myNextMove.slice(0,-1)}},mounted:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$store.state.isLoggedIn||!e.$store.state.lichessAccessToken){t.next=10;break}if(0!==Object.keys(e.mostUrgentGame).length){t.next=4;break}return t.next=4,e.getMostUrgentGame();case 4:if("string"!==typeof e.mostUrgentGame.gameId||!1!==e.isStreaming){t.next=10;break}return e.gameId=e.mostUrgentGame.gameId,e.chessGame=new $.a,e.playingGame=!0,t.next=10,e.streamGame(e.gameId);case 10:case"end":return t.stop()}}),t)})))()}}),K=E,z=(r("6b4a"),Object(u["a"])(K,P,B,!1,null,null,null)),V=z.exports,F=function(e){Object(k["a"])(r,e);var t=Object(x["a"])(r);function r(){return Object(y["a"])(this,r),t.apply(this,arguments)}return Object(w["a"])(r)}(A["b"]);F=Object(_["a"])([Object(A["a"])({components:{Login:R,Games:V}})],F);var H=F,J=H,W=Object(u["a"])(J,v,b,!1,null,null,null),q=W.exports;n["default"].use(p["a"]);var Q=[{path:"/",name:"Home",component:q}],Y=new p["a"]({routes:Q}),X=Y;n["default"].use(L["a"]);var Z=new L["a"].Store({state:{lichessAccessToken:"",isLoggedIn:!1},mutations:{setLichessAccessToken:function(e,t){e.lichessAccessToken=t},setIsLoggedIn:function(e,t){e.isLoggedIn=t}},actions:{},modules:{}});n["default"].config.productionTip=!1,new n["default"]({router:X,store:Z,render:function(e){return e(h)}}).$mount("#app")}});
//# sourceMappingURL=app.a547baa5.js.map